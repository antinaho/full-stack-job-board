---
const page_title = "Jobs";	

import JobSearch from "../../components/JobSearch.svelte";

const response = await fetch('http://localhost:8000/api/unique_jobs/'); // Replace with your endpoint
if (!response.ok) {
  throw new Error('Failed to fetch data from backend');
}
const data = await response.json();

const jobs_count = data.length
const uniqueCompanies = new Set(data.map((item) => item.company_name));
const uniqueCount = uniqueCompanies.size;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
    <title>{page_title}</title>
  </head>

  <body>
    <main>
      <h1>{jobs_count} jobs from {uniqueCount} companies</h1>

	  <JobSearch client:load jobs={data} />

    </main>

    <style>
      /* --- Page Background --- */
      body {
        background-color: #121212;
        color: #e0e0e0;
        font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
        margin: 0;
        padding: 2rem;
        display: flex;
        justify-content: center;
      }

      main {
        width: 100%;
        max-width: 900px;
      }

      /* --- Heading --- */
      h1 {
        font-size: 2rem;
        font-weight: 700;
        text-align: center;
        margin-bottom: 2rem;
        color: #ffffff;
        text-shadow: 0 0 15px rgba(0, 150, 255, 0.5);
        letter-spacing: 0.5px;
      }

      /* --- Job Grid --- */
      .jobs-grid {
        display: grid;
        gap: 1rem;
      }

      /* Slight responsive breathing room */
      @media (min-width: 600px) {
        .jobs-grid {
          gap: 1.2rem;
        }
      }
    </style>
  </body>
</html>

